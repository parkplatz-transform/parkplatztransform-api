### Parkplatz Transform

Park Platz Transform API, intended to be consumed by the Park Platz Transform app, admin and potential 3rd parties.

#### Dependencies Documentation:

| Name       | Documentation                                                                                 |
| ----------------- | --------------------------------------------------------------------------------------- |
| FastAPI            | [docs](https://fastapi.tiangolo.com/)                   |
| PostgresSQL        | [docs](https://www.postgresql.org/)           |
| PostGIS | [docs](https://postgis.net/documentation/)                         |

#### Swagger Documentation:

Autogenerated API documentation can be found [here](https://parkplatztransform-api.herokuapp.com/docs) as well as
[here](https://parkplatztransform-api.herkouapp.com/redoc)

#### Authentication and Authorization:

Authentication is done by generating a link and emailing it to a user. The user verifies they have access to the email address provided by clicking the link in the email.

See also: <br>
[Passwordless authentication](https://en.wikipedia.org/wiki/Passwordless_authentication)

Authorization is done once an email address is verified by an API endpoint. The verification endpoint will return a signed JWT, this can be provided in an `Authorization: Bearer XXX` header to make authorized requests.

#### Development:

Clients apps can likely develop against the production backend, however if you would like to work on the backend, you can follow the steps bellow:

You will need to create a `.env` file in the root directory of this project once you've cloned this repository. It should look something like the following:

```
SECRET_KEY=averysecretkey
DATABASE_URL=postgresql://postgres:postgres@postgres/postgres
MAILGUN_DOMAIN=<MAILGUN_DOMAIN> # optional, only required for testing email
MAILGUN_API_KEY=<MAILGUN_API_KEY> # optional, only required for testing email
```

The easiest way to run the API locally is by using docker and docker compose. Docker is setup for development only.
Simply run the following in the project directory:

```shell
docker-compose build
```
To build the containers and install dependencies

```shell
docker-compose up
```
To start the database and web server

The web server will be available on localhost:8023

#### Deployment

The application is currently deployed on Heroku and depends on the following third party services:
- Mailgun API for sending magic link emails
- Heroku Postgres with PostGIS extension installed

The application uses continuous integration and will automatically deploy the `main` branch on any commits.
